---
version: 1
apid_key: test-api-key
variables:
  api_url: https://jsonplaceholder.typicode.com
transactions:
  - id: transaction-one
    variables:
      api_url: https://jsonplaceholder.typicode.com
      title: delectus aut autem
      body: quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto
    steps:
      - id: hello-endpoint-one
        request:
          method: GET
          endpoint: "{{ var.api_url }}/todos/1"
          skip_ssl_verify: true

      - id: hello-endpoint-two
        request:
          method: GET
          endpoint: "{{ var.api_url }}/todos/1"
          skip_ssl_verify: true
        response:
          code: 200
          body:
            type: "plaintext"
            content: |-
              {
                "userId": 1,
                "id": 1,
                "title": "{{var.title}}",
                "completed": false
              }
        export:
          auth_cookie: response.headers.X-APIDAUTH
          first_address: response.body.addresses[0].first_line

      - id: hello-endpoint-test-get-1
        request:
          method: GET
          endpoint: "{{ var.api_url }}/posts/1"
        response:
          code: 200
          body:
            type: "json"
            content: |
              {
                "userId": 1,
                "id": 1,
                "title": "",
                "body": ""
              }
            exact: false

  - id: transaction-two
    variables:
      api_url: http://localhost:80
    steps:
      - id: health-endpoint-test-get
        request:
          method: GET
          endpoint: "{{ var.api_url }}/health"
        response:
          code: 200
          body:
            type: "plaintext"
            content: "OK"
            exact: true

      - id: echo-endpoint-test-post
        request:
          method: POST
          endpoint: "{{ var.api_url }}/echo"
          body: "some text h3re"
        response:
          code: 200
          body:
            type: "plaintext"
            content: "some text h3re"
            exact: true