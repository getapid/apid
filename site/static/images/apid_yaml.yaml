id: login-endpoint-one
variables:
  api-url: "https://login.shield.com"
request:
  method: POST
  endpoint: "{{ var.api-url }}/login"
  body: |
    {
      "username": "ironman",
      "password": "love-you-3000",
      "secret" "{% curl $VARS_API-URL/get-secret-token $}"
    }
expect:
  code: 200
  headers:
  	X-SHIELD-AUTH: "[0-9a-zA-Z]{12}"
  body:
  	type: json
    content: |
      {
      	"first_name": "Tony",
        "last_name": "Stark",
        "address": {
          "first_line": "10880 Malibu Point"
        }
      }
export:
  auth-token: response.headers.X-SHIELD-AUTH